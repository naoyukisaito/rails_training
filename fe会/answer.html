<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>javascript lesson</title>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container" style="width: 200px; margin-top: 200px">
    <div class="row">
      <div class="form-group">
        <label for="account1">大科目を選択してください</label>
        <select class="form-control jsc-select-box-primary">
        </select>
      </div>

      <div class="form-group">
        <label for="account2">小科目を選択してください</label>
        <select class="form-control jsc-select-box-secondaly">
        </select>
      </div>
    </div>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
  <script>

    var EXERCISE = {

        init: function() {
            this.setParameters();
            this.bindEvent();
        },
        setParameters: function() {
            this.$railways = [
                "沿線を選択",
                "東京メトロ丸ノ内線",
                "東京メトロ銀座線",
                "JR山手線",
                "JR中央線",
                "京王電鉄井の頭線",
                "京王電鉄京王線"
            ];
            this.$stations = [
                ["駅を選択"],
                ["池袋", "新大塚", "茗荷谷", "後楽園", "本郷三丁目", "御茶ノ水"],
                ["浅草", "田原町", "稲荷町", "上野", "上野広小路"],
                ["品川", "大崎", "五反田", "目黒", "恵比寿", "渋谷"],
                ["東京", "神田", "御茶ノ水", "四谷", "新宿"],
                ["渋谷", "神泉", "駒場東大前", "池の上", "下北沢"],
                ["新宿", "初台", "幡ヶ谷", "笹塚", "代田橋"]
            ];
            this.$window = $(window);
            this.$selectBoxPrimary = $('.jsc-select-box-primary'); //汎用性のあるネーミングで！！
            this.$selectBoxSecondaly = $('.jsc-select-box-secondaly');
        },
        bindEvent: function() {
            // proxyを使った書き方も覚えましょう
            this.$window.on('load', $.proxy(this.setInitialOptions, this));
            this.$selectBoxPrimary.on('change', $.proxy(this.changeOptions, this));

            // ↓ の書き方でも良いがproxyを使った書き方を推奨します。
            // var _self = this;
            // this.$window.on('load', function() {
            //     _self.setInitialOptions();
            // });
            // this.$selectBoxPrimary.on('change', function() {
            //     _self.changeOptions();
            // });
        },
        setInitialOptions: function() {
            var option, i, l, optionHtml; // var の定義はスコープ内の最初にまとめて定義する。（値のないものも含む）

            for (i = 0, l = this.$railways.length; i < l; i++) {
                option = this.$railways[i];
                optionHtml = '<option>' + option + '</option>';
                this.$selectBoxPrimary.append(optionHtml);
              }
        },
        changeOptions: function() {
            // varの定義はカンマで区切ってつなげて書く。値があるものは最初に書き、値がないものはあとに書く。
            var thisIndex = this.$selectBoxPrimary.find('option:selected').index(),
                options = this.$stations[thisIndex],
                option,
                optionHtml,
                i,
                l;

            this.$selectBoxSecondaly.empty();
            for (i = 0, l = options.length; i < l; i++) {
              option = options[i];
              optionHtml = '<option>' + option + '</option>'
              this.$selectBoxSecondaly.append(optionHtml);
            }
        }
    };
    EXERCISE.init();
  </script>
</body>
</html>
